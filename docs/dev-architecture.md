1. Назначение проекта

Программа предназначена для обработки и сопоставления данных по остаткам, стокам и списаниям мебели на выставке по всем складам.

Цель программы — сформировать наглядную, сопоставимую и обновляемую Excel-таблицу, позволяющую:

    -сравнивать фактические и системные остатки,
    
    -выявлять расхождения,
    
    -минимизировать ручную работу и ошибки,
    
    -обновлять данные простой заменой файлов.

Программа работает в файловом режиме, без пользовательского интерфейса.

2. Принцип работы системы

Пользователь загружает выгрузки из системы «Мой склад» в заранее определённые папки.
После загрузки файлов:

    -скрипт автоматически обрабатывает все данные,
    -сопоставляет товары по коду, 
    -формирует итоговый Excel-файл со сводной информацией.
    
Для обновления данных достаточно:
    
    -заменить файл в нужной папке, 
    -повторно запустить скрипт.

3. Архитектура входных данных (файловая модель)

    Файловая структура используется как основной интерфейс взаимодействия пользователя с системой.

3.1 Папки с системными данными

Используются для подстановки данных «по системе».

    TT310_CHR — данные ТТ310 ЧР
    
    TT310_PL — данные ТТ310 ПЛ
    
    STOCK_CHR — сток по ЧР
    
    STOCK_PL — сток по ПЛ

Файлы в этих папках могут обновляться неограниченное количество раз.

3.2 Папки с фактическими данными (источник истины)

Используются как базовый список товаров.

    FACT_CHR — фактически посчитанный товар ЧР
    
    FACT_PL — фактически посчитанный товар ПЛ

Именно из этих папок формируется перечень артикулов, которые попадают в итоговую таблицу.

4. Нормализация и сопоставление данных

Сопоставление товаров производится по коду товара.
Перед сравнением код нормализуется:

    -удаляются пробелы, точки, тире и прочие символы,
    -для сравнения используются только цифры.

Это позволяет корректно сопоставлять товары при различиях в форматировании кодов между источниками.

5. Логическая модель обработки данных
5.1 Базовые артикулы

Базовыми считаются товары, присутствующие в папках:

    -FACT_CHR
    -FACT_PL

Для каждого базового артикула:

    создаётся строка в итоговой таблице,
    к нему подтягиваются данные из всех остальных папок.

5.2 Подстановка данных

Для каждого артикула:

    -данные из системных папок подставляются по совпадению нормализованного кода,
    -при отсутствии данных значения остаются пустыми.

6. Структура итогового Excel-файла
Один запуск скрипта формирует один Excel-файл, содержащий несколько логических листов.

6.1 Лист Свод (основной)

Главный рабочий лист для анализа и принятия решений.

Группа	Столбцы
Идентификация	                 Код · Наименование
ТТ310 ЧР	                     Факт ТТ310 ЧР · ТТ310 ЧР · Разница
ЧР	                             Факт ЧР · По системе ЧР · Разница
ТТ310 ПЛ	                     Факт ТТ310 ПЛ · ТТ310 ПЛ · Разница
ПЛ	                             Факт ПЛ · По системе ПЛ · Разница

Разница рассчитывается как:
Факт − Значение по системе

6.2 Лист Факт_ввод

    -Лист для ручного заполнения фактических остатков.
    -Скрипт не перезаписывает этот лист.
    -Используется как слой пользовательского ввода.
    -Код	Наименование	Факт ЧР	Факт ПЛ	Комментарий

6.3 Лист Система_ЧР

Служебный лист с данными по ЧР.

| Код | Наименование | ТТ310 | Сток |

Используется для:

    -проверки данных,
    -анализа источников расхождений,
    -отладки.

6.4 Лист Система_ПЛ
Аналог листа Система_ЧР, но для ПЛ.

6.5 Лист Контроль_данных

Контрольный лист для выявления проблем сопоставления.

Пример структуры:

    -Код
    -Найден в FACT
    -Найден в TT310
    -Найден в STOCK
    -Комментарий / проблема

6.6 Лист Метаданные

    -Служебная информация о сборке отчёта.
    -Параметр	Значение
    -Дата формирования	
    -Количество товаров	
    -Количество файлов	
    -Версия скрипта	

7. Поток обработки данных

    -Сканирование всех входных папок
    -Загрузка и парсинг файлов
    -Нормализация кодов товаров
    -Формирование базового списка артикулов
    -Подстановка данных из системных источников
    -Расчёт разниц
    -Формирование Excel-файла

8. Обновление данных

Для обновления отчёта:

    Заменить или добавить файл в нужную папку
    Запустить скрипт повторно 
    Ручные данные на листе Факт_ввод при этом сохраняются.

9. Ограничения и допущения

Формат файлов внутри одной папки считается однородным
Итоговый Excel-файл формируется заново при каждом запуске
Пользователь не взаимодействует с программой во время выполнения

10. Итог

Архитектура проекта ориентирована на:

    -простоту использования,
    -минимизацию ручных операций, 
    -прозрачность источников данных, 
    -масштабируемость под новые склады и отчёты





